#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include <string.h>

int main()
{
	uint64_t base		= 0x180000000;

	uint64_t insecure	= 0x18001c000;
	uint64_t trampoline	= 0x180018000;
	uint64_t data		= 0x180000000;
	uint64_t stack		= 0x180014000;
	uint64_t heap		= 0x1801e8000;

	uint64_t insecure_len	= 0x1c8000;
	uint64_t trampoline_len	= 0x4000;
	uint64_t data_len	= 0xc000;
	uint64_t stack_len	= 0x4000;
	uint64_t heap_len	= 0x18000;

	uint64_t i;
	uint64_t len;
	uint8_t *ram = calloc(heap + heap_len - 0x180000000, 1);
	memset(ram + insecure - 0x180000000, 1, insecure_len);
	memset(ram + trampoline - 0x180000000, 1, trampoline_len);
	memset(ram + data - 0x180000000, 1, data_len);
	memset(ram + stack - 0x180000000, 1, stack_len);
	memset(ram + heap - 0x180000000, 1, heap_len);
	puts("Good zones:\n");
	for(i = 0; i < heap + heap_len - 0x180000000; i++)
	{
		if(ram[i] == 0)
		{
			len = 0;
			printf("%llx\t", base + i);
			while(ram[i] == 0)
			{
				i++;
				len++;
			}
			printf("%llx bytes\n", len);
			i--;
		}
	}
	return 0;
}
